"use strict";(globalThis.webpackChunkproton_pass_extension=globalThis.webpackChunkproton_pass_extension||[]).push([["node_modules_openpgp_dist_lightweight_noble_post_quantum_min_mjs"],{9891:(e,t,r)=>{r.d(t,{ml_dsa65:()=>G,ml_kem768:()=>T});var n=r(22786);"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;let o=n.c,l=n.r;function i(e,t){if(e.length!==t.length)return!1;let r=0;for(let n=0;n<e.length;n++)r|=e[n]^t[n];return 0===r}function s(...e){let t=e=>"number"==typeof e?e:e.bytesLen,r=e.reduce((e,r)=>e+t(r),0);return{bytesLen:r,encode:n=>{let l=new Uint8Array(r);for(let r=0,i=0;r<e.length;r++){let s=e[r],u=t(s),d="number"==typeof s?n[r]:s.encode(n[r]);o(d,u),l.set(d,i),"number"!=typeof s&&d.fill(0),i+=u}return l},decode:n=>{o(n,r);let l=[];for(let r of e){let e=t(r),o=n.subarray(0,e);l.push("number"==typeof r?o:r.decode(o)),n=n.subarray(e)}return l}}}function u(e,t){let r=t*e.bytesLen;return{bytesLen:r,encode:n=>{if(n.length!==t)throw Error(`vecCoder.encode: wrong length=${n.length}. Expected: ${t}`);let o=new Uint8Array(r);for(let t=0,r=0;t<n.length;t++){let l=e.encode(n[t]);o.set(l,r),l.fill(0),r+=l.length}return o},decode:t=>{o(t,r);let n=[];for(let r=0;r<t.length;r+=e.bytesLen)n.push(e.decode(t.subarray(r,r+e.bytesLen)));return n}}}function d(...e){for(let t of e)if(Array.isArray(t))for(let e of t)e.fill(0);else t.fill(0)}let f=e=>{let{newPoly:t,N:r,Q:n,F:o,ROOT_OF_UNITY:l,brvBits:i,isKyber:s}=e,u=(e,t=n)=>{let r=e%t|0;return 0|(r>=0?r:t+r)},d=function(){let e=t(r);for(let t=0;t<r;t++){let r=function(e,t=8){return Number.parseInt(e.toString(2).padStart(8,"0").slice(-t).padStart(7,"0").split("").reverse().join(""),2)}(t,i),o=BigInt(l)**BigInt(r)%BigInt(n);e[t]=0|Number(o)}return e}(),f=s?128:r,c=+!!s;return{mod:u,smod:(e,t=n)=>{let r=0|u(e,t);return 0|(r>t>>1?r-t:r)},nttZetas:d,NTT:{encode:e=>{for(let t=1,n=128;n>c;n>>=1)for(let o=0;o<r;o+=2*n){let r=d[t++];for(let t=o;t<o+n;t++){let o=u(r*e[t+n]);e[t+n]=0|u(e[t]-o),e[t]=0|u(e[t]+o)}}return e},decode:e=>{for(let t=f-1,n=1+c;n<f+c;n<<=1)for(let o=0;o<r;o+=2*n){let r=d[t--];for(let t=o;t<o+n;t++){let o=e[t];e[t]=u(o+e[t+n]),e[t+n]=u(r*(e[t+n]-o))}}for(let t=0;t<e.length;t++)e[t]=u(o*e[t]);return e}},bitsCoder:(e,n)=>{let o=(1<<e)-1,l=r/8*e;return{bytesLen:l,encode:t=>{let r=new Uint8Array(l);for(let l=0,i=0,s=0,u=0;l<t.length;l++)for(i|=(n.encode(t[l])&o)<<s,s+=e;s>=8;s-=8,i>>=8)r[u++]=i&(1<<s)-1;return r},decode:l=>{let i=t(r);for(let t=0,r=0,s=0,u=0;t<l.length;t++)for(r|=l[t]<<s,s+=8;s>=e;s-=e,r>>=e)i[u++]=n.decode(r&o);return i}}}}},c=e=>(t,r)=>{r||(r=e.blockLen);let n=new Uint8Array(t.length+2);n.set(t);let o=t.length,l=new Uint8Array(r),i=e.create({}),s=0,u=0;return{stats:()=>({calls:s,xofs:u}),get:(t,r)=>(n[o+0]=t,n[o+1]=r,i.destroy(),i=e.create({}).update(n),s++,()=>(u++,i.xofInto(l))),clean:()=>{i.destroy(),l.fill(0),n.fill(0)}}},a=c(n.l),h=c(n.s),{mod:p,nttZetas:y,NTT:g,bitsCoder:b}=f({N:256,Q:3329,F:3303,ROOT_OF_UNITY:17,newPoly:e=>new Uint16Array(e),brvBits:7,isKyber:!0}),w=e=>b(e,(e=>{if(e>=12)return{encode:e=>e,decode:e=>e};let t=2**(e-1);return{encode:t=>((t<<e)+1664.5)/3329,decode:r=>3329*r+t>>>e}})(e));function L(e,t){for(let r=0;r<256;r++)e[r]=p(e[r]+t[r])}function A(e,t){var r,n,o,l;for(let i=0;i<128;i++){let s=y[64+(i>>1)];1&i&&(s=-s);let{c0:u,c1:d}=(r=e[2*i+0],n=e[2*i+1],o=t[2*i+0],{c0:p(n*(l=t[2*i+1])*s+r*o),c1:p(r*l+n*o)});e[2*i+0]=u,e[2*i+1]=d}return e}function k(e){let t=new Uint16Array(256);for(let r=0;r<256;){let n=e();if(n.length%3)throw Error("SampleNTT: unaligned block");for(let e=0;r<256&&e+3<=n.length;e+=3){let o=4095&(n[e+0]|n[e+1]<<8),l=4095&(n[e+1]>>4|n[e+2]<<4);o<3329&&(t[r++]=o),r<256&&l<3329&&(t[r++]=l)}}return t}function m(e,t,r,o){let l=e(256*o/4,t,r),i=new Uint16Array(256),s=(0,n.m)(l),u=0;for(let e=0,t=0,r=0,n=0;e<s.length;e++){let l=s[e];for(let e=0;e<32;e++)r+=1&l,l>>=1,(u+=1)===o?(n=r,r=0):u===2*o&&(i[t++]=p(n-r),r=0,u=0)}if(u)throw Error("sampleCBD: leftover bits: "+u);return i}let E=e=>{let{K:t,PRF:r,XOF:n,HASH512:o,ETA1:l,ETA2:i,du:f,dv:c}=e,a=w(1),h=w(c),y=w(f),b=s(u(w(12),t),32),E=u(w(12),t),T=s(u(y,t),h),U=s(32,32);return{secretCoder:E,secretKeyLen:E.bytesLen,publicKeyLen:b.bytesLen,cipherTextLen:T.bytesLen,keygen:e=>{let i=new Uint8Array(33);i.set(e),i[32]=t;let s=o(i),[u,f]=U.decode(s),c=[],a=[];for(let e=0;e<t;e++)c.push(g.encode(m(r,f,e,l)));let h=n(u);for(let e=0;e<t;e++){let n=g.encode(m(r,f,t+e,l));for(let r=0;r<t;r++)L(n,A(k(h.get(r,e)),c[r]));a.push(n)}h.clean();let p={publicKey:b.encode([a,u]),secretKey:E.encode(c)};return d(u,f,c,a,i,s),p},encrypt:(e,o,s)=>{let[u,f]=b.decode(e),c=[];for(let e=0;e<t;e++)c.push(g.encode(m(r,s,e,l)));let h=n(f),p=new Uint16Array(256),y=[];for(let e=0;e<t;e++){let n=m(r,s,t+e,i),o=new Uint16Array(256);for(let r=0;r<t;r++)L(o,A(k(h.get(e,r)),c[r]));L(n,g.decode(o)),y.push(n),L(p,A(u[e],c[e])),o.fill(0)}h.clean();let w=m(r,s,2*t,i);L(w,g.decode(p));let E=a.decode(o);return L(E,w),d(u,c,p,w),T.encode([y,E])},decrypt:(e,r)=>{let[n,o]=T.decode(e),l=E.decode(r),i=new Uint16Array(256);for(let e=0;e<t;e++)L(i,A(l[e],g.encode(n[e])));return function(e,t){for(let r=0;r<256;r++)e[r]=p(e[r]-t[r])}(o,g.decode(i)),d(i,l,n),a.encode(o)}}},T=function(e){let t=E(e),{HASH256:r,HASH512:n,KDF:u}=e,{secretCoder:f,cipherTextLen:c}=t,a=t.publicKeyLen,h=s(t.secretKeyLen,t.publicKeyLen,32,32),p=h.bytesLen;return{publicKeyLen:a,msgLen:32,keygen:(e=l(64))=>{o(e,64);let{publicKey:n,secretKey:i}=t.keygen(e.subarray(0,32)),s=r(n),u=h.encode([i,n,s,e.subarray(32)]);return d(i,s),{publicKey:n,secretKey:u}},encapsulate:(s,u=l(32))=>{o(s,a),o(u,32);let c=s.subarray(0,384*e.K),h=f.encode(f.decode(c.slice()));if(!i(h,c))throw d(h),Error("ML-KEM.encapsulate: wrong publicKey modulus");d(h);let p=n.create().update(u).update(r(s)).digest(),y=t.encrypt(s,u,p.subarray(32,64));return p.subarray(32).fill(0),{cipherText:y,sharedSecret:p.subarray(0,32)}},decapsulate:(e,r)=>{o(r,p),o(e,c);let[l,s,f,a]=h.decode(r),y=t.decrypt(e,l),g=n.create().update(y).update(f).digest(),b=g.subarray(0,32),w=t.encrypt(s,y,g.subarray(32,64)),L=i(e,w),A=u.create({dkLen:32}).update(a).update(e).digest();return d(y,w,L?A:b),L?b:A}}}({...{HASH256:n.f,HASH512:n.g,KDF:n.s,XOF:a,PRF:function(e,t,r){return n.s.create({dkLen:e}).update(t).update(new Uint8Array([r])).digest()}},...{N:256,Q:3329,K:3,ETA1:2,ETA2:2,du:10,dv:4,RBGstrength:192}}),U=0|Math.floor(95232),B=0|Math.floor(261888),I=e=>new Int32Array(e),{mod:x,smod:O,NTT:_,bitsCoder:K}=f({N:256,Q:8380417,F:8347681,ROOT_OF_UNITY:1753,newPoly:I,isKyber:!1,brvBits:8}),H=e=>e,M=(e,t=H,r=H)=>K(e,{encode:e=>t(r(e)),decode:e=>r(t(e))}),S=(e,t)=>{for(let r=0;r<e.length;r++)e[r]=x(e[r]+t[r]);return e},F=(e,t)=>{for(let r=0;r<e.length;r++)e[r]=x(e[r]-t[r]);return e},v=e=>{for(let t=0;t<256;t++)e[t]<<=13;return e},N=(e,t)=>{for(let r=0;r<256;r++)if(Math.abs(O(e[r]))>=t)return!0;return!1},R=(e,t)=>{let r=I(256);for(let n=0;n<e.length;n++)r[n]=x(e[n]*t[n]);return r};function C(e){let t=I(256);for(let r=0;r<256;){let n=e();if(n.length%3)throw Error("RejNTTPoly: unaligned block");for(let e=0;r<256&&e<=n.length-3;e+=3){let o=8388607&(n[e+0]|n[e+1]<<8|n[e+2]<<16);o<8380417&&(t[r++]=o)}}return t}let X=new Uint8Array(0),G=function(e){let{K:t,L:r,GAMMA1:f,GAMMA2:c,TAU:a,ETA:h,OMEGA:p}=e,{CRH_BYTES:y,TR_BYTES:g,C_TILDE_BYTES:b,XOF128:w,XOF256:L}=e;if(![2,4].includes(h))throw Error("Wrong ETA");if(![131072,524288].includes(f))throw Error("Wrong GAMMA1");if(![U,B].includes(c))throw Error("Wrong GAMMA2");let A=a*h,k=e=>{let t=x(e),r=0|O(t,2*c);return t-r==8380416?{r1:0,r0:r-1|0}:{r1:0|Math.floor((t-r)/(2*c)),r0:r}},m=e=>k(e).r1,E=e=>k(e).r0,T=(e,t)=>{let r=Math.floor(8380416/(2*c)),{r1:n,r0:o}=k(t);return 1===e?o>0?0|x(n+1,r):0|x(n-1,r):0|n},K=e=>{let t=x(e),r=0|O(t,8192);return{r1:0|Math.floor((t-r)/8192),r0:r}},H=M(2===h?3:4,e=>h-e,e=>{if(!(-h<=e&&e<=h))throw Error(`malformed key s1/s3 ${e} outside of ETA range [${-h}, ${h}]`);return e}),G=M(13,e=>4096-e),Y=M(10),D=M(131072===f?18:20,e=>O(f-e)),P=u(M(c===U?6:4),t),j=s(32,u(Y,t)),V=s(32,32,g,u(H,r),u(H,t),u(G,t)),$=s(b,u(D,r),{bytesLen:p+t,encode:e=>{if(!1===e)throw Error("hint.encode: hint is false");let r=new Uint8Array(p+t);for(let n=0,o=0;n<t;n++){for(let t=0;t<256;t++)0!==e[n][t]&&(r[o++]=t);r[p+n]=o}return r},decode:e=>{let r=[],n=0;for(let o=0;o<t;o++){let t=I(256);if(e[p+o]<n||e[p+o]>p)return!1;for(let r=n;r<e[p+o];r++){if(r>n&&e[r]<=e[r-1])return!1;t[e[r]]=1}n=e[p+o],r.push(t)}for(let t=n;t<p;t++)if(0!==e[t])return!1;return r}}),Q=2===h?e=>e<15&&2-e%5:e=>e<9&&4-e;function W(e){let t=I(256);for(let r=0;r<256;){let n=e();for(let e=0;r<256&&e<n.length;e+=1){let o=Q(15&n[e]),l=Q(n[e]>>4&15);!1!==o&&(t[r++]=o),r<256&&!1!==l&&(t[r++]=l)}}return t}let Z=e=>{let t=I(256),r=n.s.create({}).update(e),o=new Uint8Array(n.s.blockLen);r.xofInto(o);let l=o.slice(0,8);for(let e=256-a,i=8,s=0,u=0;e<256;e++){let d=e+1;for(;d>e;)d=o[i++],i<n.s.blockLen||(r.xofInto(o),i=0);t[e]=t[d],t[d]=1-((l[s]>>u++&1)<<1),u>=8&&(s++,u=0)}return t},q=e=>{let t=I(256),r=I(256);for(let n=0;n<e.length;n++){let{r0:o,r1:l}=K(e[n]);t[n]=o,r[n]=l}return{r0:t,r1:r}},z=(e,t)=>{for(let r=0;r<256;r++)e[r]=T(t[r],e[r]);return e},J=(e,t)=>{var r,n;let o=I(256),l=0;for(let i=0;i<256;i++){let s=(r=e[i],n=t[i],r<=c||r>8380417-c||r===8380417-c&&0===n?0:1);o[i]=s,l+=s}return{v:o,cnt:l}},ee=s(32,64,32),et={signRandBytes:32,keygen:(e=l(32))=>{let o=new Uint8Array(34);o.set(e),o[32]=t,o[33]=r;let[i,s,u]=ee.decode((0,n.s)(o,{dkLen:ee.bytesLen})),f=L(s),c=[];for(let e=0;e<r;e++)c.push(W(f.get(255&e,e>>8&255)));let a=[];for(let e=r;e<r+t;e++)a.push(W(f.get(255&e,e>>8&255)));let h=c.map(e=>_.encode(e.slice())),p=[],y=[],b=w(i),A=I(256);for(let e=0;e<t;e++){A.fill(0);for(let t=0;t<r;t++)S(A,R(C(b.get(t,e)),h[t]));_.decode(A);let{r0:t,r1:n}=q(S(A,a[e]));p.push(t),y.push(n)}let k=j.encode([i,y]),m=(0,n.s)(k,{dkLen:g}),E=V.encode([i,u,m,c,a,p]);return b.clean(),f.clean(),d(i,s,u,c,a,h,A,p,y,m,o),{publicKey:k,secretKey:E}},sign:(e,l,i)=>{let[s,u,a,h,g,k]=V.decode(e),T=[],U=w(s);for(let e=0;e<t;e++){let t=[];for(let n=0;n<r;n++)t.push(C(U.get(n,e)));T.push(t)}U.clean();for(let e=0;e<r;e++)_.encode(h[e]);for(let e=0;e<t;e++)_.encode(g[e]),_.encode(k[e]);let B=n.s.create({dkLen:y}).update(a).update(l).digest(),x=i||new Uint8Array(32);o(x);let O=n.s.create({dkLen:y}).update(u).update(x).update(B).digest();o(O,y);let K=L(O,D.bytesLen);e:for(let e=0;;){let o=[];for(let t=0;t<r;t++,e++)o.push(D.decode(K.get(255&e,e>>8)()));let l=o.map(e=>_.encode(e.slice())),i=[];for(let e=0;e<t;e++){let t=I(256);for(let n=0;n<r;n++)S(t,R(T[e][n],l[n]));_.decode(t),i.push(t)}let s=i.map(e=>e.map(m)),u=n.s.create({dkLen:b}).update(B).update(P.encode(s)).digest(),a=_.encode(Z(u)),y=h.map(e=>R(e,a));for(let e=0;e<r;e++)if(S(_.decode(y[e]),o[e]),N(y[e],f-A))continue e;let w=0,L=[];for(let e=0;e<t;e++){let t=_.decode(R(g[e],a)),r=F(i[e],t).map(E);if(N(r,c-A))continue e;let n=_.decode(R(k[e],a));if(N(n,c))continue e;S(r,n);let o=J(r,s[e]);L.push(o.v),w+=o.cnt}if(w>p)continue;K.clean();let U=$.encode([u,y,L]);return d(u,y,L,a,s,i,l,o,O,B,h,g,k,...T),U}throw Error("Unreachable code path reached, report this error")},verify:(e,o,l)=>{let[s,u]=j.decode(e),d=(0,n.s)(e,{dkLen:g});if(l.length!==$.bytesLen)return!1;let[c,a,h]=$.decode(l);if(!1===h)return!1;for(let e=0;e<r;e++)if(N(a[e],f-A))return!1;let L=n.s.create({dkLen:y}).update(d).update(o).digest(),k=_.encode(Z(c)),m=a.map(e=>e.slice());for(let e=0;e<r;e++)_.encode(m[e]);let E=[],T=w(s);for(let e=0;e<t;e++){let t=R(_.encode(v(u[e])),k),n=I(256);for(let t=0;t<r;t++)S(n,R(C(T.get(t,e)),m[t]));let o=_.decode(F(n,t));E.push(z(o,h[e]))}T.clean();let U=n.s.create({dkLen:b}).update(L).update(P.encode(E)).digest();for(let e of h)if(!(e.reduce((e,t)=>e+t,0)<=p))return!1;for(let e of a)if(N(e,f-A))return!1;return i(c,U)}},er=(e,t=X)=>{if(o(e),o(t),t.length>255)throw Error("context should be less than 255 bytes");return(0,n.d)(new Uint8Array([0,t.length]),t,e)};return{internal:et,keygen:et.keygen,signRandBytes:et.signRandBytes,sign:(e,t,r=X,n)=>{let o=er(t,r),l=et.sign(e,o,n);return o.fill(0),l},verify:(e,t,r,n=X)=>et.verify(e,er(t,n),r)}}({K:6,L:5,D:13,GAMMA1:524288,GAMMA2:B,TAU:49,ETA:4,OMEGA:55,CRH_BYTES:64,TR_BYTES:64,C_TILDE_BYTES:48,XOF128:a,XOF256:h})},22786:(e,t,r)=>{r.d(t,{H:()=>L,a:()=>i,b:()=>s,c:()=>l,d:()=>w,e:()=>h,f:()=>V,g:()=>$,h:()=>c,i:()=>u,j:()=>a,k:()=>_,l:()=>W,m:()=>f,r:()=>k,s:()=>Z,t:()=>b,u:()=>g,w:()=>A});let n="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function o(e){if(!Number.isSafeInteger(e)||e<0)throw Error("positive integer expected, got "+e)}function l(e,...t){if(!(e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name))throw Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw Error("Uint8Array expected of length "+t+", got length="+e.length)}function i(e){if("function"!=typeof e||"function"!=typeof e.create)throw Error("Hash should be wrapped by utils.wrapConstructor");o(e.outputLen),o(e.blockLen)}function s(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")}function u(e,t){l(e);let r=t.outputLen;if(e.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}let d="object"==typeof n&&"crypto"in n?n.crypto:void 0,f=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),c=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),a=(e,t)=>e<<32-t|e>>>t,h=(e,t)=>e<<t|e>>>32-t>>>0,p=68===new Uint8Array(new Uint32Array([0x11223344]).buffer)[0];function y(e){var t;for(let r=0;r<e.length;r++)e[r]=(t=e[r])<<24&0xff000000|t<<8&0xff0000|t>>>8&65280|t>>>24&255}function g(e){if("string"!=typeof e)throw Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array((new TextEncoder).encode(e))}function b(e){return"string"==typeof e&&(e=g(e)),l(e),e}function w(...e){let t=0;for(let r=0;r<e.length;r++){let n=e[r];l(n),t+=n.length}let r=new Uint8Array(t);for(let t=0,n=0;t<e.length;t++){let o=e[t];r.set(o,n),n+=o.length}return r}class L{clone(){return this._cloneInto()}}function A(e){let t=t=>e().update(b(t)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function k(e=32){if(d&&"function"==typeof d.getRandomValues)return d.getRandomValues(new Uint8Array(e));if(d&&"function"==typeof d.randomBytes)return d.randomBytes(e);throw Error("crypto.getRandomValues must be defined")}let m=BigInt(0x100000000-1),E=BigInt(32);function T(e,t=!1){return t?{h:Number(e&m),l:Number(e>>E&m)}:{h:0|Number(e>>E&m),l:0|Number(e&m)}}function U(e,t=!1){let r=new Uint32Array(e.length),n=new Uint32Array(e.length);for(let o=0;o<e.length;o++){let{h:l,l:i}=T(e[o],t);[r[o],n[o]]=[l,i]}return[r,n]}let B=(e,t,r)=>e<<r|t>>>32-r,I=(e,t,r)=>t<<r|e>>>32-r,x=(e,t,r)=>t<<r-32|e>>>64-r,O=(e,t,r)=>e<<r-32|t>>>64-r,_={fromBig:T,split:U,toBig:(e,t)=>BigInt(e>>>0)<<E|BigInt(t>>>0),shrSH:(e,t,r)=>e>>>r,shrSL:(e,t,r)=>e<<32-r|t>>>r,rotrSH:(e,t,r)=>e>>>r|t<<32-r,rotrSL:(e,t,r)=>e<<32-r|t>>>r,rotrBH:(e,t,r)=>e<<64-r|t>>>r-32,rotrBL:(e,t,r)=>e>>>r-32|t<<64-r,rotr32H:(e,t)=>t,rotr32L:(e,t)=>e,rotlSH:B,rotlSL:I,rotlBH:x,rotlBL:O,add:function(e,t,r,n){let o=(t>>>0)+(n>>>0);return{h:e+r+(o/0x100000000|0)|0,l:0|o}},add3L:(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),add3H:(e,t,r,n)=>t+r+n+(e/0x100000000|0)|0,add4L:(e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0),add4H:(e,t,r,n,o)=>t+r+n+o+(e/0x100000000|0)|0,add5H:(e,t,r,n,o,l)=>t+r+n+o+l+(e/0x100000000|0)|0,add5L:(e,t,r,n,o)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(o>>>0)},K=[],H=[],M=[],S=BigInt(0),F=BigInt(1),v=BigInt(2),N=BigInt(7),R=BigInt(256),C=BigInt(113);for(let e=0,t=F,r=1,n=0;e<24;e++){[r,n]=[n,(2*r+3*n)%5],K.push(2*(5*n+r)),H.push((e+1)*(e+2)/2%64);let o=S;for(let e=0;e<7;e++)(t=(t<<F^(t>>N)*C)%R)&v&&(o^=F<<(F<<BigInt(e))-F);M.push(o)}let[X,G]=U(M,!0),Y=(e,t,r)=>r>32?x(e,t,r):B(e,t,r),D=(e,t,r)=>r>32?O(e,t,r):I(e,t,r);class P extends L{constructor(e,t,r,n=!1,l=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=r,this.enableXOF=n,this.rounds=l,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,o(r),0>=this.blockLen||this.blockLen>=200)throw Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=f(this.state)}keccak(){p||y(this.state32),function(e,t=24){let r=new Uint32Array(10);for(let n=24-t;n<24;n++){for(let t=0;t<10;t++)r[t]=e[t]^e[t+10]^e[t+20]^e[t+30]^e[t+40];for(let t=0;t<10;t+=2){let n=(t+8)%10,o=(t+2)%10,l=r[o],i=r[o+1],s=Y(l,i,1)^r[n],u=D(l,i,1)^r[n+1];for(let r=0;r<50;r+=10)e[t+r]^=s,e[t+r+1]^=u}let t=e[2],o=e[3];for(let r=0;r<24;r++){let n=H[r],l=Y(t,o,n),i=D(t,o,n),s=K[r];t=e[s],o=e[s+1],e[s]=l,e[s+1]=i}for(let t=0;t<50;t+=10){for(let n=0;n<10;n++)r[n]=e[t+n];for(let n=0;n<10;n++)e[t+n]^=~r[(n+2)%10]&r[(n+4)%10]}e[0]^=X[n],e[1]^=G[n]}r.fill(0)}(this.state32,this.rounds),p||y(this.state32),this.posOut=0,this.pos=0}update(e){s(this);let{blockLen:t,state:r}=this,n=(e=b(e)).length;for(let o=0;o<n;){let l=Math.min(t-this.pos,n-o);for(let t=0;t<l;t++)r[this.pos++]^=e[o++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:e,suffix:t,pos:r,blockLen:n}=this;e[r]^=t,128&t&&r===n-1&&this.keccak(),e[n-1]^=128,this.keccak()}writeInto(e){s(this,!1),l(e),this.finish();let t=this.state,{blockLen:r}=this;for(let n=0,o=e.length;n<o;){this.posOut>=r&&this.keccak();let l=Math.min(r-this.posOut,o-n);e.set(t.subarray(this.posOut,this.posOut+l),n),this.posOut+=l,n+=l}return e}xofInto(e){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return o(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(u(e,this),this.finished)throw Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){let{blockLen:t,suffix:r,outputLen:n,rounds:o,enableXOF:l}=this;return e||(e=new P(t,r,n,l,o)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=o,e.suffix=r,e.outputLen=n,e.enableXOF=l,e.destroyed=this.destroyed,e}}let j=(e,t,r)=>A(()=>new P(t,e,r)),V=j(6,136,32),$=j(6,72,64),Q=(e,t,r)=>(function(e){let t=(t,r)=>e(r).update(b(t)).digest(),r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=t=>e(t),t})((n={})=>new P(t,e,void 0===n.dkLen?r:n.dkLen,!0)),W=Q(31,168,16),Z=Q(31,136,32)}}]);
