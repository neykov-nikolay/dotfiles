"use strict";(globalThis.webpackChunkproton_pass_extension=globalThis.webpackChunkproton_pass_extension||[]).push([["node_modules_openpgp_dist_lightweight_noble_curves_min_mjs"],{22786:(t,e,r)=>{r.d(e,{H:()=>w,a:()=>o,b:()=>a,c:()=>f,d:()=>y,e:()=>u,f:()=>K,g:()=>M,h:()=>c,i:()=>s,j:()=>h,k:()=>H,l:()=>W,m:()=>d,r:()=>m,s:()=>X,t:()=>x,u:()=>p,w:()=>B});let n="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function i(t){if(!Number.isSafeInteger(t)||t<0)throw Error("positive integer expected, got "+t)}function f(t,...e){if(!(t instanceof Uint8Array||ArrayBuffer.isView(t)&&"Uint8Array"===t.constructor.name))throw Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw Error("Uint8Array expected of length "+e+", got length="+t.length)}function o(t){if("function"!=typeof t||"function"!=typeof t.create)throw Error("Hash should be wrapped by utils.wrapConstructor");i(t.outputLen),i(t.blockLen)}function a(t,e=!0){if(t.destroyed)throw Error("Hash instance has been destroyed");if(e&&t.finished)throw Error("Hash#digest() has already been called")}function s(t,e){f(t);let r=e.outputLen;if(t.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}let l="object"==typeof n&&"crypto"in n?n.crypto:void 0,d=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),c=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),h=(t,e)=>t<<32-e|t>>>e,u=(t,e)=>t<<e|t>>>32-e>>>0,b=68===new Uint8Array(new Uint32Array([0x11223344]).buffer)[0];function g(t){var e;for(let r=0;r<t.length;r++)t[r]=(e=t[r])<<24&0xff000000|e<<8&0xff0000|e>>>8&65280|e>>>24&255}function p(t){if("string"!=typeof t)throw Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array((new TextEncoder).encode(t))}function x(t){return"string"==typeof t&&(t=p(t)),f(t),t}function y(...t){let e=0;for(let r=0;r<t.length;r++){let n=t[r];f(n),e+=n.length}let r=new Uint8Array(e);for(let e=0,n=0;e<t.length;e++){let i=t[e];r.set(i,n),n+=i.length}return r}class w{clone(){return this._cloneInto()}}function B(t){let e=e=>t().update(x(e)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function m(t=32){if(l&&"function"==typeof l.getRandomValues)return l.getRandomValues(new Uint8Array(t));if(l&&"function"==typeof l.randomBytes)return l.randomBytes(t);throw Error("crypto.getRandomValues must be defined")}let E=BigInt(0x100000000-1),I=BigInt(32);function v(t,e=!1){return e?{h:Number(t&E),l:Number(t>>I&E)}:{h:0|Number(t>>I&E),l:0|Number(t&E)}}function S(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let i=0;i<t.length;i++){let{h:f,l:o}=v(t[i],e);[r[i],n[i]]=[f,o]}return[r,n]}let A=(t,e,r)=>t<<r|e>>>32-r,k=(t,e,r)=>e<<r|t>>>32-r,L=(t,e,r)=>e<<r-32|t>>>64-r,O=(t,e,r)=>t<<r-32|e>>>64-r,H={fromBig:v,split:S,toBig:(t,e)=>BigInt(t>>>0)<<I|BigInt(e>>>0),shrSH:(t,e,r)=>t>>>r,shrSL:(t,e,r)=>t<<32-r|e>>>r,rotrSH:(t,e,r)=>t>>>r|e<<32-r,rotrSL:(t,e,r)=>t<<32-r|e>>>r,rotrBH:(t,e,r)=>t<<64-r|e>>>r-32,rotrBL:(t,e,r)=>t>>>r-32|e<<64-r,rotr32H:(t,e)=>e,rotr32L:(t,e)=>t,rotlSH:A,rotlSL:k,rotlBH:L,rotlBL:O,add:function(t,e,r,n){let i=(e>>>0)+(n>>>0);return{h:t+r+(i/0x100000000|0)|0,l:0|i}},add3L:(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),add3H:(t,e,r,n)=>e+r+n+(t/0x100000000|0)|0,add4L:(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),add4H:(t,e,r,n,i)=>e+r+n+i+(t/0x100000000|0)|0,add5H:(t,e,r,n,i,f)=>e+r+n+i+f+(t/0x100000000|0)|0,add5L:(t,e,r,n,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(i>>>0)},R=[],U=[],F=[],z=BigInt(0),N=BigInt(1),q=BigInt(2),C=BigInt(7),P=BigInt(256),G=BigInt(113);for(let t=0,e=N,r=1,n=0;t<24;t++){[r,n]=[n,(2*r+3*n)%5],R.push(2*(5*n+r)),U.push((t+1)*(t+2)/2%64);let i=z;for(let t=0;t<7;t++)(e=(e<<N^(e>>C)*G)%P)&q&&(i^=N<<(N<<BigInt(t))-N);F.push(i)}let[T,j]=S(F,!0),_=(t,e,r)=>r>32?L(t,e,r):A(t,e,r),Z=(t,e,r)=>r>32?O(t,e,r):k(t,e,r);class D extends w{constructor(t,e,r,n=!1,f=24){if(super(),this.blockLen=t,this.suffix=e,this.outputLen=r,this.enableXOF=n,this.rounds=f,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,i(r),0>=this.blockLen||this.blockLen>=200)throw Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=d(this.state)}keccak(){b||g(this.state32),function(t,e=24){let r=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let e=0;e<10;e++)r[e]=t[e]^t[e+10]^t[e+20]^t[e+30]^t[e+40];for(let e=0;e<10;e+=2){let n=(e+8)%10,i=(e+2)%10,f=r[i],o=r[i+1],a=_(f,o,1)^r[n],s=Z(f,o,1)^r[n+1];for(let r=0;r<50;r+=10)t[e+r]^=a,t[e+r+1]^=s}let e=t[2],i=t[3];for(let r=0;r<24;r++){let n=U[r],f=_(e,i,n),o=Z(e,i,n),a=R[r];e=t[a],i=t[a+1],t[a]=f,t[a+1]=o}for(let e=0;e<50;e+=10){for(let n=0;n<10;n++)r[n]=t[e+n];for(let n=0;n<10;n++)t[e+n]^=~r[(n+2)%10]&r[(n+4)%10]}t[0]^=T[n],t[1]^=j[n]}r.fill(0)}(this.state32,this.rounds),b||g(this.state32),this.posOut=0,this.pos=0}update(t){a(this);let{blockLen:e,state:r}=this,n=(t=x(t)).length;for(let i=0;i<n;){let f=Math.min(e-this.pos,n-i);for(let e=0;e<f;e++)r[this.pos++]^=t[i++];this.pos===e&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:t,suffix:e,pos:r,blockLen:n}=this;t[r]^=e,128&e&&r===n-1&&this.keccak(),t[n-1]^=128,this.keccak()}writeInto(t){a(this,!1),f(t),this.finish();let e=this.state,{blockLen:r}=this;for(let n=0,i=t.length;n<i;){this.posOut>=r&&this.keccak();let f=Math.min(r-this.posOut,i-n);t.set(e.subarray(this.posOut,this.posOut+f),n),this.posOut+=f,n+=f}return t}xofInto(t){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return i(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(s(t,this),this.finished)throw Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(t){let{blockLen:e,suffix:r,outputLen:n,rounds:i,enableXOF:f}=this;return t||(t=new D(e,r,n,f,i)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=i,t.suffix=r,t.outputLen=n,t.enableXOF=f,t.destroyed=this.destroyed,t}}let V=(t,e,r)=>B(()=>new D(e,t,r)),K=V(6,136,32),M=V(6,72,64),Y=(t,e,r)=>(function(t){let e=(e,r)=>t(r).update(x(e)).digest(),r=t({});return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=e=>t(e),e})((n={})=>new D(e,t,void 0===n.dkLen?r:n.dkLen,!0)),W=Y(31,168,16),X=Y(31,136,32)},62377:(t,e,r)=>{r.d(e,{C:()=>i,H:()=>o,M:()=>f,a:()=>m,b:()=>B,c:()=>u,s:()=>h});var n=r(22786);"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;let i=(t,e,r)=>t&e^~t&r,f=(t,e,r)=>t&e^t&r^e&r;class o extends n.H{constructor(t,e,r,i){super(),this.blockLen=t,this.outputLen=e,this.padOffset=r,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=(0,n.h)(this.buffer)}update(t){(0,n.b)(this);let{view:e,buffer:r,blockLen:i}=this,f=(t=(0,n.t)(t)).length;for(let o=0;o<f;){let a=Math.min(i-this.pos,f-o);if(a!==i)r.set(t.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===i&&(this.process(e,0),this.pos=0);else{let e=(0,n.h)(t);for(;i<=f-o;o+=i)this.process(e,o)}}return this.length+=t.length,this.roundClean(),this}digestInto(t){(0,n.b)(this),(0,n.i)(t,this),this.finished=!0;let{buffer:e,view:r,blockLen:i,isLE:f}=this,{pos:o}=this;e[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>i-o&&(this.process(r,0),o=0);for(let t=o;t<i;t++)e[t]=0;!function(t,e,r,n){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,r,n);let i=BigInt(32),f=BigInt(0xffffffff),o=Number(r>>i&f),a=Number(r&f),s=4*!!n,l=4*!n;t.setUint32(e+s,o,n),t.setUint32(e+l,a,n)}(r,i-8,BigInt(8*this.length),f),this.process(r,0);let a=(0,n.h)(t),s=this.outputLen;if(s%4)throw Error("_sha2: outputLen should be aligned to 32bit");let l=s/4,d=this.get();if(l>d.length)throw Error("_sha2: outputLen bigger than state");for(let t=0;t<l;t++)a.setUint32(4*t,d[t],f)}digest(){let{buffer:t,outputLen:e}=this;this.digestInto(t);let r=t.slice(0,e);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:e,buffer:r,length:n,finished:i,destroyed:f,pos:o}=this;return t.length=n,t.pos=o,t.finished=i,t.destroyed=f,n%e&&t.buffer.set(r),t}}let a=new Uint32Array([0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,0xe49b69c1,0xefbe4786,0xfc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x6ca6351,0x14292967,0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2]),s=new Uint32Array([0x6a09e667,0xbb67ae85,0x3c6ef372,0xa54ff53a,0x510e527f,0x9b05688c,0x1f83d9ab,0x5be0cd19]),l=new Uint32Array(64);class d extends o{constructor(){super(64,32,8,!1),this.A=0|s[0],this.B=0|s[1],this.C=0|s[2],this.D=0|s[3],this.E=0|s[4],this.F=0|s[5],this.G=0|s[6],this.H=0|s[7]}get(){let{A:t,B:e,C:r,D:n,E:i,F:f,G:o,H:a}=this;return[t,e,r,n,i,f,o,a]}set(t,e,r,n,i,f,o,a){this.A=0|t,this.B=0|e,this.C=0|r,this.D=0|n,this.E=0|i,this.F=0|f,this.G=0|o,this.H=0|a}process(t,e){for(let r=0;r<16;r++,e+=4)l[r]=t.getUint32(e,!1);for(let t=16;t<64;t++){let e=l[t-15],r=l[t-2],i=(0,n.j)(e,7)^(0,n.j)(e,18)^e>>>3,f=(0,n.j)(r,17)^(0,n.j)(r,19)^r>>>10;l[t]=f+l[t-7]+i+l[t-16]|0}let{A:r,B:o,C:s,D:d,E:c,F:h,G:u,H:b}=this;for(let t=0;t<64;t++){let e=b+((0,n.j)(c,6)^(0,n.j)(c,11)^(0,n.j)(c,25))+i(c,h,u)+a[t]+l[t]|0,g=((0,n.j)(r,2)^(0,n.j)(r,13)^(0,n.j)(r,22))+f(r,o,s)|0;b=u,u=h,h=c,c=d+e|0,d=s,s=o,o=r,r=e+g|0}r=r+this.A|0,o=o+this.B|0,s=s+this.C|0,d=d+this.D|0,c=c+this.E|0,h=h+this.F|0,u=u+this.G|0,b=b+this.H|0,this.set(r,o,s,d,c,h,u,b)}roundClean(){l.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class c extends d{constructor(){super(),this.A=-0x3efa6128,this.B=0x367cd507,this.C=0x3070dd17,this.D=-0x8f1a6c7,this.E=-4191439,this.F=0x68581511,this.G=0x64f98fa7,this.H=-0x4105b05c,this.outputLen=28}}let h=(0,n.w)(()=>new d),u=(0,n.w)(()=>new c),[b,g]=n.k.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),p=new Uint32Array(80),x=new Uint32Array(80);class y extends o{constructor(){super(128,64,16,!1),this.Ah=0x6a09e667,this.Al=-0xc4336f8,this.Bh=-0x4498517b,this.Bl=-0x7b3558c5,this.Ch=0x3c6ef372,this.Cl=-0x16b07d5,this.Dh=-0x5ab00ac6,this.Dl=0x5f1d36f1,this.Eh=0x510e527f,this.El=-0x52197d2f,this.Fh=-0x64fa9774,this.Fl=0x2b3e6c1f,this.Gh=0x1f83d9ab,this.Gl=-0x4be4295,this.Hh=0x5be0cd19,this.Hl=0x137e2179}get(){let{Ah:t,Al:e,Bh:r,Bl:n,Ch:i,Cl:f,Dh:o,Dl:a,Eh:s,El:l,Fh:d,Fl:c,Gh:h,Gl:u,Hh:b,Hl:g}=this;return[t,e,r,n,i,f,o,a,s,l,d,c,h,u,b,g]}set(t,e,r,n,i,f,o,a,s,l,d,c,h,u,b,g){this.Ah=0|t,this.Al=0|e,this.Bh=0|r,this.Bl=0|n,this.Ch=0|i,this.Cl=0|f,this.Dh=0|o,this.Dl=0|a,this.Eh=0|s,this.El=0|l,this.Fh=0|d,this.Fl=0|c,this.Gh=0|h,this.Gl=0|u,this.Hh=0|b,this.Hl=0|g}process(t,e){for(let r=0;r<16;r++,e+=4)p[r]=t.getUint32(e),x[r]=t.getUint32(e+=4);for(let t=16;t<80;t++){let e=0|p[t-15],r=0|x[t-15],i=n.k.rotrSH(e,r,1)^n.k.rotrSH(e,r,8)^n.k.shrSH(e,r,7),f=n.k.rotrSL(e,r,1)^n.k.rotrSL(e,r,8)^n.k.shrSL(e,r,7),o=0|p[t-2],a=0|x[t-2],s=n.k.rotrSH(o,a,19)^n.k.rotrBH(o,a,61)^n.k.shrSH(o,a,6),l=n.k.rotrSL(o,a,19)^n.k.rotrBL(o,a,61)^n.k.shrSL(o,a,6),d=n.k.add4L(f,l,x[t-7],x[t-16]),c=n.k.add4H(d,i,s,p[t-7],p[t-16]);p[t]=0|c,x[t]=0|d}let{Ah:r,Al:i,Bh:f,Bl:o,Ch:a,Cl:s,Dh:l,Dl:d,Eh:c,El:h,Fh:u,Fl:y,Gh:w,Gl:B,Hh:m,Hl:E}=this;for(let t=0;t<80;t++){let e=n.k.rotrSH(c,h,14)^n.k.rotrSH(c,h,18)^n.k.rotrBH(c,h,41),I=n.k.rotrSL(c,h,14)^n.k.rotrSL(c,h,18)^n.k.rotrBL(c,h,41),v=c&u^~c&w,S=h&y^~h&B,A=n.k.add5L(E,I,S,g[t],x[t]),k=n.k.add5H(A,m,e,v,b[t],p[t]),L=0|A,O=n.k.rotrSH(r,i,28)^n.k.rotrBH(r,i,34)^n.k.rotrBH(r,i,39),H=n.k.rotrSL(r,i,28)^n.k.rotrBL(r,i,34)^n.k.rotrBL(r,i,39),R=r&f^r&a^f&a,U=i&o^i&s^o&s;m=0|w,E=0|B,w=0|u,B=0|y,u=0|c,y=0|h,({h:c,l:h}=n.k.add(0|l,0|d,0|k,0|L)),l=0|a,d=0|s,a=0|f,s=0|o,f=0|r,o=0|i;let F=n.k.add3L(L,H,U);r=n.k.add3H(F,k,O,R),i=0|F}({h:r,l:i}=n.k.add(0|this.Ah,0|this.Al,0|r,0|i)),({h:f,l:o}=n.k.add(0|this.Bh,0|this.Bl,0|f,0|o)),({h:a,l:s}=n.k.add(0|this.Ch,0|this.Cl,0|a,0|s)),({h:l,l:d}=n.k.add(0|this.Dh,0|this.Dl,0|l,0|d)),({h:c,l:h}=n.k.add(0|this.Eh,0|this.El,0|c,0|h)),({h:u,l:y}=n.k.add(0|this.Fh,0|this.Fl,0|u,0|y)),({h:w,l:B}=n.k.add(0|this.Gh,0|this.Gl,0|w,0|B)),({h:m,l:E}=n.k.add(0|this.Hh,0|this.Hl,0|m,0|E)),this.set(r,i,f,o,a,s,l,d,c,h,u,y,w,B,m,E)}roundClean(){p.fill(0),x.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class w extends y{constructor(){super(),this.Ah=-0x344462a3,this.Al=-0x3efa6128,this.Bh=0x629a292a,this.Bl=0x367cd507,this.Ch=-0x6ea6fea6,this.Cl=0x3070dd17,this.Dh=0x152fecd8,this.Dl=-0x8f1a6c7,this.Eh=0x67332667,this.El=-4191439,this.Fh=-0x714bb579,this.Fl=0x68581511,this.Gh=-0x24f3d1f3,this.Gl=0x64f98fa7,this.Hh=0x47b5481d,this.Hl=-0x4105b05c,this.outputLen=48}}let B=(0,n.w)(()=>new y),m=(0,n.w)(()=>new w)},84676:(t,e,r)=>{r.d(e,{nobleCurves:()=>t4});var n=r(62377),i=r(22786);"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;class f extends i.H{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,(0,i.a)(t);let r=(0,i.t)(e);if(this.iHash=t.create(),"function"!=typeof this.iHash.update)throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let n=this.blockLen,f=new Uint8Array(n);f.set(r.length>n?t.create().update(r).digest():r);for(let t=0;t<f.length;t++)f[t]^=54;this.iHash.update(f),this.oHash=t.create();for(let t=0;t<f.length;t++)f[t]^=106;this.oHash.update(f),f.fill(0)}update(t){return(0,i.b)(this),this.iHash.update(t),this}digestInto(t){(0,i.b)(this),(0,i.c)(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:e,iHash:r,finished:n,destroyed:i,blockLen:f,outputLen:o}=this;return t.finished=n,t.destroyed=i,t.blockLen=f,t.outputLen=o,t.oHash=e._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}let o=(t,e,r)=>new f(t,e).update(r).digest();o.create=(t,e)=>new f(t,e);let a=BigInt(0),s=BigInt(1),l=BigInt(2);function d(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&"Uint8Array"===t.constructor.name}function c(t){if(!d(t))throw Error("Uint8Array expected")}function h(t,e){if("boolean"!=typeof e)throw Error(t+" boolean expected, got "+e)}let u=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function b(t){c(t);let e="";for(let r=0;r<t.length;r++)e+=u[t[r]];return e}function g(t){let e=t.toString(16);return 1&e.length?"0"+e:e}function p(t){if("string"!=typeof t)throw Error("hex string expected, got "+typeof t);return""===t?a:BigInt("0x"+t)}let x={_0:48,_9:57,A:65,F:70,a:97,f:102};function y(t){return t>=x._0&&t<=x._9?t-x._0:t>=x.A&&t<=x.F?t-(x.A-10):t>=x.a&&t<=x.f?t-(x.a-10):void 0}function w(t){if("string"!=typeof t)throw Error("hex string expected, got "+typeof t);let e=t.length,r=e/2;if(e%2)throw Error("hex string expected, got unpadded hex of length "+e);let n=new Uint8Array(r);for(let e=0,i=0;e<r;e++,i+=2){let r=y(t.charCodeAt(i)),f=y(t.charCodeAt(i+1));if(void 0===r||void 0===f)throw Error('hex string expected, got non-hex character "'+(t[i]+t[i+1])+'" at index '+i);n[e]=16*r+f}return n}function B(t){return p(b(t))}function m(t){return c(t),p(b(Uint8Array.from(t).reverse()))}function E(t,e){return w(t.toString(16).padStart(2*e,"0"))}function I(t,e){return E(t,e).reverse()}function v(t,e,r){let n;if("string"==typeof e)try{n=w(e)}catch(e){throw Error(t+" must be hex string or Uint8Array, cause: "+e)}else{if(!d(e))throw Error(t+" must be hex string or Uint8Array");n=Uint8Array.from(e)}let i=n.length;if("number"==typeof r&&i!==r)throw Error(t+" of length "+r+" expected, got "+i);return n}function S(...t){let e=0;for(let r=0;r<t.length;r++){let n=t[r];c(n),e+=n.length}let r=new Uint8Array(e);for(let e=0,n=0;e<t.length;e++){let i=t[e];r.set(i,n),n+=i.length}return r}let A=t=>"bigint"==typeof t&&a<=t;function k(t,e,r){return A(t)&&A(e)&&A(r)&&e<=t&&t<r}function L(t,e,r,n){if(!k(e,r,n))throw Error("expected valid "+t+": "+r+" <= n < "+n+", got "+e)}function O(t){let e;for(e=0;t>a;t>>=s,e+=1);return e}let H=t=>(l<<BigInt(t-1))-s,R=t=>new Uint8Array(t),U=t=>Uint8Array.from(t);function F(t,e,r){if("number"!=typeof t||t<2)throw Error("hashLen must be a number");if("number"!=typeof e||e<2)throw Error("qByteLen must be a number");if("function"!=typeof r)throw Error("hmacFn must be a function");let n=R(t),i=R(t),f=0,o=()=>{n.fill(1),i.fill(0),f=0},a=(...t)=>r(i,n,...t),s=(t=R())=>{i=a(U([0]),t),n=a(),0!==t.length&&(i=a(U([1]),t),n=a())},l=()=>{if(f++>=1e3)throw Error("drbg: tried 1000 values");let t=0,r=[];for(;t<e;){let e=(n=a()).slice();r.push(e),t+=n.length}return S(...r)};return(t,e)=>{let r;for(o(),s(t);!(r=e(l()));)s();return o(),r}}let z={bigint:t=>"bigint"==typeof t,function:t=>"function"==typeof t,boolean:t=>"boolean"==typeof t,string:t=>"string"==typeof t,stringOrUint8Array:t=>"string"==typeof t||d(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>"function"==typeof t&&Number.isSafeInteger(t.outputLen)};function N(t,e,r={}){let n=(e,r,n)=>{let i=z[r];if("function"!=typeof i)throw Error("invalid validator function");let f=t[e];if(!(n&&void 0===f||i(f,t)))throw Error("param "+e+" is invalid. Expected "+r+", got "+f)};for(let[t,r]of Object.entries(e))n(t,r,!1);for(let[t,e]of Object.entries(r))n(t,e,!0);return t}function q(t){let e=new WeakMap;return(r,...n)=>{let i=e.get(r);if(void 0!==i)return i;let f=t(r,...n);return e.set(r,f),f}}var C=Object.freeze({__proto__:null,aInRange:L,abool:h,abytes:c,bitGet:function(t,e){return t>>BigInt(e)&s},bitLen:O,bitMask:H,bitSet:function(t,e,r){return t|(r?s:a)<<BigInt(e)},bytesToHex:b,bytesToNumberBE:B,bytesToNumberLE:m,concatBytes:S,createHmacDrbg:F,ensureBytes:v,equalBytes:function(t,e){if(t.length!==e.length)return!1;let r=0;for(let n=0;n<t.length;n++)r|=t[n]^e[n];return 0===r},hexToBytes:w,hexToNumber:p,inRange:k,isBytes:d,memoized:q,notImplemented:()=>{throw Error("not implemented")},numberToBytesBE:E,numberToBytesLE:I,numberToHexUnpadded:g,numberToVarBytesBE:function(t){return w(g(t))},utf8ToBytes:function(t){if("string"!=typeof t)throw Error("string expected");return new Uint8Array((new TextEncoder).encode(t))},validateObject:N});let P=BigInt(0),G=BigInt(1),T=BigInt(2),j=BigInt(3),_=BigInt(4),Z=BigInt(5),D=BigInt(8);function V(t,e){let r=t%e;return r>=P?r:e+r}function K(t,e,r){if(e<P)throw Error("invalid exponent, negatives unsupported");if(r<=P)throw Error("invalid modulus");if(r===G)return P;let n=G;for(;e>P;)e&G&&(n=n*t%r),t=t*t%r,e>>=G;return n}function M(t,e,r){let n=t;for(;e-- >P;)n*=n,n%=r;return n}function Y(t,e){if(t===P)throw Error("invert: expected non-zero number");if(e<=P)throw Error("invert: expected positive modulus, got "+e);let r=V(t,e),n=e,i=P,f=G;for(;r!==P;){let t=n%r,e=i-n/r*f;n=r,r=t,i=f,f=e}if(n!==G)throw Error("invert: does not exist");return V(i,e)}let W=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function X(t,e){let r=void 0!==e?e:t.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}function J(t,e,r=!1,n={}){let i;if(t<=P)throw Error("invalid field: expected ORDER > 0, got "+t);let{nBitLength:f,nByteLength:o}=X(t,e);if(o>2048)throw Error("invalid field: expected ORDER of <= 2048 bytes");let a=Object.freeze({ORDER:t,BITS:f,BYTES:o,MASK:H(f),ZERO:P,ONE:G,create:e=>V(e,t),isValid:e=>{if("bigint"!=typeof e)throw Error("invalid field element: expected bigint, got "+typeof e);return P<=e&&e<t},is0:t=>t===P,isOdd:t=>(t&G)===G,neg:e=>V(-e,t),eql:(t,e)=>t===e,sqr:e=>V(e*e,t),add:(e,r)=>V(e+r,t),sub:(e,r)=>V(e-r,t),mul:(e,r)=>V(e*r,t),pow:(t,e)=>(function(t,e,r){if(r<P)throw Error("invalid exponent, negatives unsupported");if(r===P)return t.ONE;if(r===G)return e;let n=t.ONE,i=e;for(;r>P;)r&G&&(n=t.mul(n,i)),i=t.sqr(i),r>>=G;return n})(a,t,e),div:(e,r)=>V(e*Y(r,t),t),sqrN:t=>t*t,addN:(t,e)=>t+e,subN:(t,e)=>t-e,mulN:(t,e)=>t*e,inv:e=>Y(e,t),sqrt:n.sqrt||(e=>(i||(i=function(t){if(t%_===j){let e=(t+G)/_;return function(t,r){let n=t.pow(r,e);if(!t.eql(t.sqr(n),r))throw Error("Cannot find square root");return n}}if(t%D===Z){let e=(t-Z)/D;return function(t,r){let n=t.mul(r,T),i=t.pow(n,e),f=t.mul(r,i),o=t.mul(t.mul(f,T),i),a=t.mul(f,t.sub(o,t.ONE));if(!t.eql(t.sqr(a),r))throw Error("Cannot find square root");return a}}return function(t){let e,r,n,i=(t-G)/T;for(e=t-G,r=0;e%T===P;e/=T,r++);for(n=T;n<t&&K(n,i,t)!==t-G;n++)if(n>1e3)throw Error("Cannot find square root: likely non-prime P");if(1===r){let e=(t+G)/_;return function(t,r){let n=t.pow(r,e);if(!t.eql(t.sqr(n),r))throw Error("Cannot find square root");return n}}let f=(e+G)/T;return function(t,o){if(t.pow(o,i)===t.neg(t.ONE))throw Error("Cannot find square root");let a=r,s=t.pow(t.mul(t.ONE,n),e),l=t.pow(o,f),d=t.pow(o,e);for(;!t.eql(d,t.ONE);){if(t.eql(d,t.ZERO))return t.ZERO;let e=1;for(let r=t.sqr(d);e<a&&!t.eql(r,t.ONE);e++)r=t.sqr(r);let r=t.pow(s,G<<BigInt(a-e-1));s=t.sqr(r),l=t.mul(l,r),d=t.mul(d,s),a=e}return l}}(t)}(t)),i(a,e))),invertBatch:t=>(function(t,e){let r=Array(e.length),n=e.reduce((e,n,i)=>t.is0(n)?e:(r[i]=e,t.mul(e,n)),t.ONE),i=t.inv(n);return e.reduceRight((e,n,i)=>t.is0(n)?e:(r[i]=t.mul(e,r[i]),t.mul(e,n)),i),r})(a,t),cmov:(t,e,r)=>r?e:t,toBytes:t=>r?I(t,o):E(t,o),fromBytes:t=>{if(t.length!==o)throw Error("Field.fromBytes: expected "+o+" bytes, got "+t.length);return r?m(t):B(t)}});return Object.freeze(a)}function Q(t){if("bigint"!=typeof t)throw Error("field order must be bigint");return Math.ceil(t.toString(2).length/8)}function $(t){let e=Q(t);return e+Math.ceil(e/2)}let tt=BigInt(0),te=BigInt(1);function tr(t,e){let r=e.negate();return t?r:e}function tn(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw Error("invalid window size, expected [1.."+e+"], got W="+t)}function ti(t,e){return tn(t,e),{windows:Math.ceil(e/t)+1,windowSize:2**(t-1)}}let tf=new WeakMap,to=new WeakMap;function ta(t){return to.get(t)||1}function ts(t,e){return{constTimeNegate:tr,hasPrecomputes:t=>1!==ta(t),unsafeLadder(e,r,n=t.ZERO){let i=e;for(;r>tt;)r&te&&(n=n.add(i)),i=i.double(),r>>=te;return n},precomputeWindow(t,r){let{windows:n,windowSize:i}=ti(r,e),f=[],o=t,a=o;for(let t=0;t<n;t++){a=o,f.push(a);for(let t=1;t<i;t++)a=a.add(o),f.push(a);o=a.double()}return f},wNAF(r,n,i){let{windows:f,windowSize:o}=ti(r,e),a=t.ZERO,s=t.BASE,l=BigInt(2**r-1),d=2**r,c=BigInt(r);for(let t=0;t<f;t++){let e=t*o,r=Number(i&l);i>>=c,r>o&&(r-=d,i+=te);let f=e+Math.abs(r)-1,h=t%2!=0,u=r<0;0===r?s=s.add(tr(h,n[e])):a=a.add(tr(u,n[f]))}return{p:a,f:s}},wNAFUnsafe(r,n,i,f=t.ZERO){let{windows:o,windowSize:a}=ti(r,e),s=BigInt(2**r-1),l=2**r,d=BigInt(r);for(let t=0;t<o;t++){let e=t*a;if(i===tt)break;let r=Number(i&s);if(i>>=d,r>a&&(r-=l,i+=te),0===r)continue;let o=n[e+Math.abs(r)-1];r<0&&(o=o.negate()),f=f.add(o)}return f},getPrecomputes(t,e,r){let n=tf.get(e);return n||(n=this.precomputeWindow(e,t),1!==t&&tf.set(e,r(n))),n},wNAFCached(t,e,r){let n=ta(t);return this.wNAF(n,this.getPrecomputes(n,t,r),e)},wNAFCachedUnsafe(t,e,r,n){let i=ta(t);return 1===i?this.unsafeLadder(t,e,n):this.wNAFUnsafe(i,this.getPrecomputes(i,t,r),e,n)},setWindowSize(t,r){tn(r,e),to.set(t,r),tf.delete(t)}}}function tl(t,e,r,n){if(function(t,e){if(!Array.isArray(t))throw Error("array expected");t.forEach((t,r)=>{if(!(t instanceof e))throw Error("invalid point at index "+r)})}(r,t),function(t,e){if(!Array.isArray(t))throw Error("array of scalars expected");t.forEach((t,r)=>{if(!e.isValid(t))throw Error("invalid scalar at index "+r)})}(n,e),r.length!==n.length)throw Error("arrays of points and scalars must have equal length");let i=t.ZERO,f=O(BigInt(r.length)),o=f>12?f-3:f>4?f-2:f?2:1,a=(1<<o)-1,s=Array(a+1).fill(i),l=i;for(let t=Math.floor((e.BITS-1)/o)*o;t>=0;t-=o){s.fill(i);for(let e=0;e<n.length;e++){let i=Number(n[e]>>BigInt(t)&BigInt(a));s[i]=s[i].add(r[e])}let e=i;for(let t=s.length-1,r=i;t>0;t--)r=r.add(s[t]),e=e.add(r);if(l=l.add(e),0!==t)for(let t=0;t<o;t++)l=l.double()}return l}function td(t){return N(t.Fp,W.reduce((t,e)=>(t[e]="function",t),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"})),N(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...X(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}function tc(t){void 0!==t.lowS&&h("lowS",t.lowS),void 0!==t.prehash&&h("prehash",t.prehash)}let{bytesToNumberBE:th,hexToBytes:tu}=C,tb={Err:class extends Error{constructor(t=""){super(t)}},_tlv:{encode:(t,e)=>{let{Err:r}=tb;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(1&e.length)throw new r("tlv.encode: unpadded data");let n=e.length/2,i=g(n);if(i.length/2&128)throw new r("tlv.encode: long form length too big");let f=n>127?g(i.length/2|128):"";return g(t)+f+i+e},decode(t,e){let{Err:r}=tb,n=0;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length<2||e[n++]!==t)throw new r("tlv.decode: wrong tlv");let i=e[n++],f=0;if(128&i){let t=127&i;if(!t)throw new r("tlv.decode(long): indefinite length not supported");if(t>4)throw new r("tlv.decode(long): byte length is too big");let o=e.subarray(n,n+t);if(o.length!==t)throw new r("tlv.decode: length bytes not complete");if(0===o[0])throw new r("tlv.decode(long): zero leftmost byte");for(let t of o)f=f<<8|t;if(n+=t,f<128)throw new r("tlv.decode(long): not minimal encoding")}else f=i;let o=e.subarray(n,n+f);if(o.length!==f)throw new r("tlv.decode: wrong value length");return{v:o,l:e.subarray(n+f)}}},_int:{encode(t){let{Err:e}=tb;if(t<tg)throw new e("integer: negative integers are not allowed");let r=g(t);if(8&Number.parseInt(r[0],16)&&(r="00"+r),1&r.length)throw new e("unexpected DER parsing assertion: unpadded hex");return r},decode(t){let{Err:e}=tb;if(128&t[0])throw new e("invalid signature integer: negative");if(0===t[0]&&!(128&t[1]))throw new e("invalid signature integer: unnecessary leading zero");return th(t)}},toSig(t){let{Err:e,_int:r,_tlv:n}=tb,i="string"==typeof t?tu(t):t;c(i);let{v:f,l:o}=n.decode(48,i);if(o.length)throw new e("invalid signature: left bytes after parsing");let{v:a,l:s}=n.decode(2,f),{v:l,l:d}=n.decode(2,s);if(d.length)throw new e("invalid signature: left bytes after parsing");return{r:r.decode(a),s:r.decode(l)}},hexFromSig(t){let{_tlv:e,_int:r}=tb,n=e.encode(2,r.encode(t.r))+e.encode(2,r.encode(t.s));return e.encode(48,n)}},tg=BigInt(0),tp=BigInt(1);BigInt(2);let tx=BigInt(3);function ty(t,e){let r=e=>(function(t){let e=function(t){let e=td(t);return N(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}(t),{Fp:r,n:n}=e,i=r.BYTES+1,f=2*r.BYTES+1;function o(t){return V(t,n)}let{ProjectivePoint:a,normPrivateKeyToScalar:s,weierstrassEquation:l,isWithinCurveOrder:c}=function(t){let e=function(t){let e=td(t);N(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:r,Fp:n,a:i}=e;if(r){if(!n.eql(i,n.ZERO))throw Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if("object"!=typeof r||"bigint"!=typeof r.beta||"function"!=typeof r.splitScalar)throw Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...e})}(t),{Fp:r}=e,n=J(e.n,e.nBitLength),i=e.toBytes||((t,e,n)=>{let i=e.toAffine();return S(Uint8Array.from([4]),r.toBytes(i.x),r.toBytes(i.y))}),f=e.fromBytes||(t=>{let e=t.subarray(1);return{x:r.fromBytes(e.subarray(0,r.BYTES)),y:r.fromBytes(e.subarray(r.BYTES,2*r.BYTES))}});function o(t){let{a:n,b:i}=e,f=r.sqr(t),o=r.mul(f,t);return r.add(r.add(o,r.mul(t,n)),i)}if(!r.eql(r.sqr(e.Gy),o(e.Gx)))throw Error("bad generator point: equation left != right");function a(t){let r,{allowedPrivateKeyLengths:n,nByteLength:i,wrapPrivateKey:f,n:o}=e;if(n&&"bigint"!=typeof t){if(d(t)&&(t=b(t)),"string"!=typeof t||!n.includes(t.length))throw Error("invalid private key");t=t.padStart(2*i,"0")}try{r="bigint"==typeof t?t:B(v("private key",t,i))}catch(e){throw Error("invalid private key, expected hex or "+i+" bytes, got "+typeof t)}return f&&(r=V(r,o)),L("private key",r,tp,o),r}function s(t){if(!(t instanceof u))throw Error("ProjectivePoint expected")}let l=q((t,e)=>{let{px:n,py:i,pz:f}=t;if(r.eql(f,r.ONE))return{x:n,y:i};let o=t.is0();null==e&&(e=o?r.ONE:r.inv(f));let a=r.mul(n,e),s=r.mul(i,e),l=r.mul(f,e);if(o)return{x:r.ZERO,y:r.ZERO};if(!r.eql(l,r.ONE))throw Error("invZ was invalid");return{x:a,y:s}}),c=q(t=>{if(t.is0()){if(e.allowInfinityPoint&&!r.is0(t.py))return;throw Error("bad point: ZERO")}let{x:n,y:i}=t.toAffine();if(!r.isValid(n)||!r.isValid(i))throw Error("bad point: x or y not FE");let f=r.sqr(i),a=o(n);if(!r.eql(f,a))throw Error("bad point: equation left != right");if(!t.isTorsionFree())throw Error("bad point: not in prime-order subgroup");return!0});class u{constructor(t,e,n){if(this.px=t,this.py=e,this.pz=n,null==t||!r.isValid(t))throw Error("x required");if(null==e||!r.isValid(e))throw Error("y required");if(null==n||!r.isValid(n))throw Error("z required");Object.freeze(this)}static fromAffine(t){let{x:e,y:n}=t||{};if(!t||!r.isValid(e)||!r.isValid(n))throw Error("invalid affine point");if(t instanceof u)throw Error("projective point not allowed");let i=t=>r.eql(t,r.ZERO);return i(e)&&i(n)?u.ZERO:new u(e,n,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(t){let e=r.invertBatch(t.map(t=>t.pz));return t.map((t,r)=>t.toAffine(e[r])).map(u.fromAffine)}static fromHex(t){let e=u.fromAffine(f(v("pointHex",t)));return e.assertValidity(),e}static fromPrivateKey(t){return u.BASE.multiply(a(t))}static msm(t,e){return tl(u,n,t,e)}_setWindowSize(t){p.setWindowSize(this,t)}assertValidity(){c(this)}hasEvenY(){let{y:t}=this.toAffine();if(r.isOdd)return!r.isOdd(t);throw Error("Field doesn't support isOdd")}equals(t){s(t);let{px:e,py:n,pz:i}=this,{px:f,py:o,pz:a}=t,l=r.eql(r.mul(e,a),r.mul(f,i)),d=r.eql(r.mul(n,a),r.mul(o,i));return l&&d}negate(){return new u(this.px,r.neg(this.py),this.pz)}double(){let{a:t,b:n}=e,i=r.mul(n,tx),{px:f,py:o,pz:a}=this,s=r.ZERO,l=r.ZERO,d=r.ZERO,c=r.mul(f,f),h=r.mul(o,o),b=r.mul(a,a),g=r.mul(f,o);return g=r.add(g,g),d=r.mul(f,a),d=r.add(d,d),s=r.mul(t,d),l=r.mul(i,b),l=r.add(s,l),s=r.sub(h,l),l=r.add(h,l),l=r.mul(s,l),s=r.mul(g,s),d=r.mul(i,d),b=r.mul(t,b),g=r.sub(c,b),g=r.mul(t,g),g=r.add(g,d),d=r.add(c,c),c=r.add(d,c),c=r.add(c,b),c=r.mul(c,g),l=r.add(l,c),b=r.mul(o,a),b=r.add(b,b),c=r.mul(b,g),s=r.sub(s,c),d=r.mul(b,h),d=r.add(d,d),new u(s,l,d=r.add(d,d))}add(t){s(t);let{px:n,py:i,pz:f}=this,{px:o,py:a,pz:l}=t,d=r.ZERO,c=r.ZERO,h=r.ZERO,b=e.a,g=r.mul(e.b,tx),p=r.mul(n,o),x=r.mul(i,a),y=r.mul(f,l),w=r.add(n,i),B=r.add(o,a);w=r.mul(w,B),B=r.add(p,x),w=r.sub(w,B),B=r.add(n,f);let m=r.add(o,l);return B=r.mul(B,m),m=r.add(p,y),B=r.sub(B,m),m=r.add(i,f),d=r.add(a,l),m=r.mul(m,d),d=r.add(x,y),m=r.sub(m,d),h=r.mul(b,B),d=r.mul(g,y),h=r.add(d,h),d=r.sub(x,h),h=r.add(x,h),c=r.mul(d,h),x=r.add(p,p),x=r.add(x,p),y=r.mul(b,y),B=r.mul(g,B),x=r.add(x,y),y=r.sub(p,y),y=r.mul(b,y),B=r.add(B,y),p=r.mul(x,B),c=r.add(c,p),p=r.mul(m,B),d=r.mul(w,d),d=r.sub(d,p),p=r.mul(w,x),h=r.mul(m,h),new u(d,c,h=r.add(h,p))}subtract(t){return this.add(t.negate())}is0(){return this.equals(u.ZERO)}wNAF(t){return p.wNAFCached(this,t,u.normalizeZ)}multiplyUnsafe(t){let{endo:n,n:i}=e;L("scalar",t,tg,i);let f=u.ZERO;if(t===tg)return f;if(this.is0()||t===tp)return this;if(!n||p.hasPrecomputes(this))return p.wNAFCachedUnsafe(this,t,u.normalizeZ);let{k1neg:o,k1:a,k2neg:s,k2:l}=n.splitScalar(t),d=f,c=f,h=this;for(;a>tg||l>tg;)a&tp&&(d=d.add(h)),l&tp&&(c=c.add(h)),h=h.double(),a>>=tp,l>>=tp;return o&&(d=d.negate()),s&&(c=c.negate()),c=new u(r.mul(c.px,n.beta),c.py,c.pz),d.add(c)}multiply(t){let n,i,{endo:f,n:o}=e;if(L("scalar",t,tp,o),f){let{k1neg:e,k1:o,k2neg:a,k2:s}=f.splitScalar(t),{p:l,f:d}=this.wNAF(o),{p:c,f:h}=this.wNAF(s);l=p.constTimeNegate(e,l),c=p.constTimeNegate(a,c),c=new u(r.mul(c.px,f.beta),c.py,c.pz),n=l.add(c),i=d.add(h)}else{let{p:e,f:r}=this.wNAF(t);n=e,i=r}return u.normalizeZ([n,i])[0]}multiplyAndAddUnsafe(t,e,r){let n=u.BASE,i=(t,e)=>e!==tg&&e!==tp&&t.equals(n)?t.multiply(e):t.multiplyUnsafe(e),f=i(this,e).add(i(t,r));return f.is0()?void 0:f}toAffine(t){return l(this,t)}isTorsionFree(){let{h:t,isTorsionFree:r}=e;if(t===tp)return!0;if(r)return r(u,this);throw Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:t,clearCofactor:r}=e;return t===tp?this:r?r(u,this):this.multiplyUnsafe(e.h)}toRawBytes(t=!0){return h("isCompressed",t),this.assertValidity(),i(u,this,t)}toHex(t=!0){return h("isCompressed",t),b(this.toRawBytes(t))}}u.BASE=new u(e.Gx,e.Gy,r.ONE),u.ZERO=new u(r.ZERO,r.ONE,r.ZERO);let g=e.nBitLength,p=ts(u,e.endo?Math.ceil(g/2):g);return{CURVE:e,ProjectivePoint:u,normPrivateKeyToScalar:a,weierstrassEquation:o,isWithinCurveOrder:function(t){return k(t,tp,e.n)}}}({...e,toBytes(t,e,n){let i=e.toAffine(),f=r.toBytes(i.x);return h("isCompressed",n),n?S(Uint8Array.from([e.hasEvenY()?2:3]),f):S(Uint8Array.from([4]),f,r.toBytes(i.y))},fromBytes(t){let e=t.length,n=t[0],o=t.subarray(1);if(e!==i||2!==n&&3!==n){if(e===f&&4===n)return{x:r.fromBytes(o.subarray(0,r.BYTES)),y:r.fromBytes(o.subarray(r.BYTES,2*r.BYTES))};throw Error("invalid Point, expected length of "+i+", or uncompressed "+f+", got "+e)}{let t,e=B(o);if(!k(e,tp,r.ORDER))throw Error("Point is not on curve");let i=l(e);try{t=r.sqrt(i)}catch(t){throw Error("Point is not on curve"+(t instanceof Error?": "+t.message:""))}return!(1&~n)!=((t&tp)===tp)&&(t=r.neg(t)),{x:e,y:t}}}}),u=t=>b(E(t,e.nByteLength)),g=(t,e,r)=>B(t.slice(e,r));class p{constructor(t,e,r){this.r=t,this.s=e,this.recovery=r,this.assertValidity()}static fromCompact(t){let r=e.nByteLength;return new p(g(t=v("compactSignature",t,2*r),0,r),g(t,r,2*r))}static fromDER(t){let{r:e,s:r}=tb.toSig(v("DER",t));return new p(e,r)}assertValidity(){L("r",this.r,tp,n),L("s",this.s,tp,n)}addRecoveryBit(t){return new p(this.r,this.s,t)}recoverPublicKey(t){let{r:i,s:f,recovery:s}=this,l=A(v("msgHash",t));if(null==s||![0,1,2,3].includes(s))throw Error("recovery id invalid");let d=2===s||3===s?i+e.n:i;if(d>=r.ORDER)throw Error("recovery id 2 or 3 invalid");let c=1&s?"03":"02",h=a.fromHex(c+u(d)),b=Y(d,n),g=o(-l*b),p=o(f*b),x=a.BASE.multiplyAndAddUnsafe(h,g,p);if(!x)throw Error("point at infinify");return x.assertValidity(),x}hasHighS(){return this.s>n>>tp}normalizeS(){return this.hasHighS()?new p(this.r,o(-this.s),this.recovery):this}toDERRawBytes(){return w(this.toDERHex())}toDERHex(){return tb.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return w(this.toCompactHex())}toCompactHex(){return u(this.r)+u(this.s)}}function x(t){let e=d(t),r="string"==typeof t,n=(e||r)&&t.length;return e?n===i||n===f:r?n===2*i||n===2*f:t instanceof a}let y=e.bits2int||function(t){if(t.length>8192)throw Error("input is too large");let r=B(t),n=8*t.length-e.nBitLength;return n>0?r>>BigInt(n):r},A=e.bits2int_modN||function(t){return o(y(t))},O=H(e.nBitLength);function R(t){return L("num < 2^"+e.nBitLength,t,tg,O),E(t,e.nByteLength)}let U={lowS:e.lowS,prehash:!1},z={lowS:e.lowS,prehash:!1};return a.BASE._setWindowSize(8),{CURVE:e,getPublicKey:function(t,e=!0){return a.fromPrivateKey(t).toRawBytes(e)},getSharedSecret:function(t,e,r=!0){if(x(t))throw Error("first arg must be private key");if(!x(e))throw Error("second arg must be public key");return a.fromHex(e).multiply(s(t)).toRawBytes(r)},sign:function(t,i,f=U){let{seed:l,k2sig:d}=function(t,i,f=U){if(["recovered","canonical"].some(t=>t in f))throw Error("sign() legacy options not supported");let{hash:l,randomBytes:d}=e,{lowS:h,prehash:u,extraEntropy:b}=f;null==h&&(h=!0),t=v("msgHash",t),tc(f),u&&(t=v("prehashed msgHash",l(t)));let g=A(t),x=s(i),w=[R(x),R(g)];if(null!=b&&!1!==b){let t=!0===b?d(r.BYTES):b;w.push(v("extraEntropy",t))}return{seed:S(...w),k2sig:function(t){let e=y(t);if(!c(e))return;let r=Y(e,n),i=a.BASE.multiply(e).toAffine(),f=o(i.x);if(f===tg)return;let s=o(r*o(g+f*x));if(s===tg)return;let l=2*(i.x!==f)|Number(i.y&tp),d=s;return h&&s>n>>tp&&(d=s>n>>tp?o(-s):s,l^=1),new p(f,d,l)}}}(t,i,f);return F(e.hash.outputLen,e.nByteLength,e.hmac)(l,d)},verify:function(t,r,i,f=z){let s,l;r=v("msgHash",r),i=v("publicKey",i);let{lowS:c,prehash:h,format:u}=f;if(tc(f),"strict"in f)throw Error("options.strict was renamed to lowS");if(void 0!==u&&"compact"!==u&&"der"!==u)throw Error("format must be compact or der");let b="string"==typeof t||d(t),g=!b&&!u&&"object"==typeof t&&null!==t&&"bigint"==typeof t.r&&"bigint"==typeof t.s;if(!b&&!g)throw Error("invalid signature, expected Uint8Array, hex string or Signature instance");try{if(g&&(s=new p(t.r,t.s)),b){try{"compact"!==u&&(s=p.fromDER(t))}catch(t){if(!(t instanceof tb.Err))throw t}s||"der"===u||(s=p.fromCompact(t))}l=a.fromHex(i)}catch(t){return!1}if(!s||c&&s.hasHighS())return!1;h&&(r=e.hash(r));let{r:x,s:y}=s,w=A(r),B=Y(y,n),m=o(w*B),E=o(x*B),I=a.BASE.multiplyAndAddUnsafe(l,m,E)?.toAffine();return!!I&&o(I.x)===x},ProjectivePoint:a,Signature:p,utils:{isValidPrivateKey(t){try{return s(t),!0}catch(t){return!1}},normPrivateKeyToScalar:s,randomPrivateKey:()=>{let t=$(e.n);return function(t,e,r=!1){let n=t.length,i=Q(e),f=$(e);if(n<16||n<f||n>1024)throw Error("expected "+f+"-1024 bytes of input, got "+n);let o=V(r?B(t):m(t),e-G)+G;return r?I(o,i):E(o,i)}(e.randomBytes(t),e.n)},precompute:(t=8,e=a.BASE)=>(e._setWindowSize(t),e.multiply(BigInt(3)),e)}}})({...t,...{hash:e,hmac:(t,...r)=>o(e,t,(0,i.d)(...r)),randomBytes:i.r}});return Object.freeze({...r(e),create:r})}BigInt(4);let tw=J(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),tB=ty({a:tw.create(BigInt("-3")),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Fp:tw,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},n.s),tm=J(BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff")),tE=ty({a:tm.create(BigInt("-3")),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Fp:tm,n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f"),h:BigInt(1),lowS:!1},n.a),tI=J(BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff")),tv={a:tI.create(BigInt("-3")),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Fp:tI,n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650"),h:BigInt(1)},tS=ty({a:tv.a,b:tv.b,Fp:tI,n:tv.n,Gx:tv.Gx,Gy:tv.Gy,h:tv.h,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},n.b),tA=BigInt(0),tk=BigInt(1),tL=BigInt(2),tO=BigInt(8),tH={zip215:!0},tR=BigInt(0),tU=BigInt(1),tF=(0,i.w)(()=>i.s.create({dkLen:114})),tz=((0,i.w)(()=>i.s.create({dkLen:64})),BigInt("726838724295606890549323807888004534353641360687318060281490199180612328166730772686396383698676545930088884461843637361053498018365439")),tN=BigInt(1),tq=BigInt(2),tC=BigInt(3);BigInt(4);let tP=BigInt(11),tG=BigInt(22),tT=BigInt(44),tj=BigInt(88),t_=BigInt(223);function tZ(t){let e=t*t*t%tz,r=e*e*t%tz,n=M(r,tC,tz)*r%tz,i=M(n,tC,tz)*r%tz,f=M(i,tq,tz)*e%tz,o=M(f,tP,tz)*f%tz,a=M(o,tG,tz)*o%tz,s=M(a,tT,tz)*a%tz,l=M(s,tj,tz)*s%tz,d=M(l,tT,tz)*a%tz,c=M(d,tq,tz)*e%tz,h=M(c,tN,tz)*t%tz;return M(h,t_,tz)*c%tz}function tD(t){return t[0]&=252,t[55]|=128,t[56]=0,t}let tV=J(tz,456,!0),tK=function(t){let e=function(t){let e=td(t);return N(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}(t),{Fp:r,n:n,prehash:i,hash:f,randomBytes:o,nByteLength:a,h:s}=e,l=tL<<BigInt(8*a)-tk,d=r.create,c=J(e.n,e.nBitLength),u=e.uvRatio||((t,e)=>{try{return{isValid:!0,value:r.sqrt(t*r.inv(e))}}catch(t){return{isValid:!1,value:tA}}}),g=e.adjustScalarBytes||(t=>t),p=e.domain||((t,e,r)=>{if(h("phflag",r),e.length||r)throw Error("Contexts/pre-hash are not supported");return t});function x(t,e){L("coordinate "+t,e,tA,l)}function y(t){if(!(t instanceof E))throw Error("ExtendedPoint expected")}let w=q((t,e)=>{let{ex:n,ey:i,ez:f}=t,o=t.is0();null==e&&(e=o?tO:r.inv(f));let a=d(n*e),s=d(i*e),l=d(f*e);if(o)return{x:tA,y:tk};if(l!==tk)throw Error("invZ was invalid");return{x:a,y:s}}),B=q(t=>{let{a:r,d:n}=e;if(t.is0())throw Error("bad point: ZERO");let{ex:i,ey:f,ez:o,et:a}=t,s=d(i*i),l=d(f*f),c=d(o*o),h=d(c*c),u=d(s*r);if(d(c*d(u+l))!==d(h+d(n*d(s*l))))throw Error("bad point: equation left != right (1)");if(d(i*f)!==d(o*a))throw Error("bad point: equation left != right (2)");return!0});class E{constructor(t,e,r,n){this.ex=t,this.ey=e,this.ez=r,this.et=n,x("x",t),x("y",e),x("z",r),x("t",n),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(t){if(t instanceof E)throw Error("extended point not allowed");let{x:e,y:r}=t||{};return x("x",e),x("y",r),new E(e,r,tk,d(e*r))}static normalizeZ(t){let e=r.invertBatch(t.map(t=>t.ez));return t.map((t,r)=>t.toAffine(e[r])).map(E.fromAffine)}static msm(t,e){return tl(E,c,t,e)}_setWindowSize(t){O.setWindowSize(this,t)}assertValidity(){B(this)}equals(t){y(t);let{ex:e,ey:r,ez:n}=this,{ex:i,ey:f,ez:o}=t,a=d(e*o),s=d(i*n),l=d(r*o),c=d(f*n);return a===s&&l===c}is0(){return this.equals(E.ZERO)}negate(){return new E(d(-this.ex),this.ey,this.ez,d(-this.et))}double(){let{a:t}=e,{ex:r,ey:n,ez:i}=this,f=d(r*r),o=d(n*n),a=d(tL*d(i*i)),s=d(t*f),l=r+n,c=d(d(l*l)-f-o),h=s+o,u=h-a,b=s-o,g=d(c*u),p=d(h*b),x=d(c*b);return new E(g,p,d(u*h),x)}add(t){y(t);let{a:r,d:n}=e,{ex:i,ey:f,ez:o,et:a}=this,{ex:s,ey:l,ez:c,et:h}=t;if(r===BigInt(-1)){let t=d((f-i)*(l+s)),e=d((f+i)*(l-s)),r=d(e-t);if(r===tA)return this.double();let n=d(o*tL*h),u=d(a*tL*c),b=u+n,g=e+t,p=u-n,x=d(b*r),y=d(g*p),w=d(b*p);return new E(x,y,d(r*g),w)}let u=d(i*s),b=d(f*l),g=d(a*n*h),p=d(o*c),x=d((i+f)*(s+l)-u-b),w=p-g,B=p+g,m=d(b-r*u),I=d(x*w),v=d(B*m),S=d(x*m);return new E(I,v,d(w*B),S)}subtract(t){return this.add(t.negate())}wNAF(t){return O.wNAFCached(this,t,E.normalizeZ)}multiply(t){L("scalar",t,tk,n);let{p:e,f:r}=this.wNAF(t);return E.normalizeZ([e,r])[0]}multiplyUnsafe(t,e=E.ZERO){return L("scalar",t,tA,n),t===tA?k:this.is0()||t===tk?this:O.wNAFCachedUnsafe(this,t,E.normalizeZ,e)}isSmallOrder(){return this.multiplyUnsafe(s).is0()}isTorsionFree(){return O.unsafeLadder(this,n).is0()}toAffine(t){return w(this,t)}clearCofactor(){let{h:t}=e;return t===tk?this:this.multiplyUnsafe(t)}static fromHex(t,n=!1){let{d:i,a:f}=e,o=r.BYTES;t=v("pointHex",t,o),h("zip215",n);let a=t.slice(),s=t[o-1];a[o-1]=-129&s;let c=m(a);L("pointHex.y",c,tA,n?l:r.ORDER);let b=d(c*c),{isValid:g,value:p}=u(d(b-tk),d(i*b-f));if(!g)throw Error("Point.fromHex: invalid y coordinate");let x=(p&tk)===tk,y=!!(128&s);if(!n&&p===tA&&y)throw Error("Point.fromHex: x=0 and x_0=1");return y!==x&&(p=d(-p)),E.fromAffine({x:p,y:c})}static fromPrivateKey(t){return H(t).point}toRawBytes(){let{x:t,y:e}=this.toAffine(),n=I(e,r.BYTES);return n[n.length-1]|=t&tk?128:0,n}toHex(){return b(this.toRawBytes())}}E.BASE=new E(e.Gx,e.Gy,tk,d(e.Gx*e.Gy)),E.ZERO=new E(tA,tk,tk,tA);let{BASE:A,ZERO:k}=E,O=ts(E,8*a);function H(t){let e=r.BYTES;t=v("private key",t,e);let i=v("hashed private key",f(t),2*e),o=g(i.slice(0,e)),a=i.slice(e,2*e),s=V(m(o),n),l=A.multiply(s),d=l.toRawBytes();return{head:o,prefix:a,scalar:s,point:l,pointBytes:d}}function R(t=new Uint8Array,...e){return V(m(f(p(S(...e),v("context",t),!!i))),n)}return A._setWindowSize(8),{CURVE:e,getPublicKey:function(t){return H(t).pointBytes},sign:function(t,e,f={}){t=v("message",t),i&&(t=i(t));let{prefix:o,scalar:a,pointBytes:s}=H(e),l=R(f.context,o,t),d=A.multiply(l).toRawBytes(),c=V(l+R(f.context,d,s,t)*a,n);return L("signature.s",c,tA,n),v("result",S(d,I(c,r.BYTES)),2*r.BYTES)},verify:function(t,e,n,f=tH){let o,a,s,{context:l,zip215:d}=f,c=r.BYTES;t=v("signature",t,2*c),e=v("message",e),n=v("publicKey",n,c),void 0!==d&&h("zip215",d),i&&(e=i(e));let u=m(t.slice(c,2*c));try{o=E.fromHex(n,d),a=E.fromHex(t.slice(0,c),d),s=A.multiplyUnsafe(u)}catch(t){return!1}if(!d&&o.isSmallOrder())return!1;let b=R(l,a.toRawBytes(),o.toRawBytes(),e);return a.add(o.multiplyUnsafe(b)).subtract(s).clearCofactor().equals(E.ZERO)},ExtendedPoint:E,utils:{getExtendedPublicKey:H,randomPrivateKey:()=>o(r.BYTES),precompute:(t=8,e=E.BASE)=>(e._setWindowSize(t),e.multiply(BigInt(3)),e)}}}({a:BigInt(1),d:BigInt("726838724295606890549323807888004534353641360687318060281490199180612328166730772686396383698676545930088884461843637361053498018326358"),Fp:tV,n:BigInt("181709681073901722637330951972001133588410340171829515070372549795146003961539585716195755291692375963310293709091662304773755859649779"),nBitLength:456,h:BigInt(4),Gx:BigInt("224580040295924300187604334099896036246789641632564134246125461686950415467406032909029192869357953282578032075146446173674602635247710"),Gy:BigInt("298819210078481492676017930443930673437544040154080242095928241372331506189835876003536878655418784733982303233503462500531545062832660"),hash:tF,randomBytes:i.r,adjustScalarBytes:tD,domain:(t,e,r)=>{if(e.length>255)throw Error("context must be smaller than 255, got: "+e.length);return(0,i.d)((0,i.u)("SigEd448"),new Uint8Array([+!!r,e.length]),e,t)},uvRatio:function(t,e){let r=V(t*t*e,tz),n=V(r*t,tz),i=V(n*r*e,tz),f=V(n*tZ(i),tz),o=V(f*f,tz);return{isValid:V(o*e,tz)===t,value:f}}}),tM=function(t){let e=(N(t,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...t})),{P:r}=e,n=t=>V(t,r),i=e.montgomeryBits,f=Math.ceil(i/8),o=e.nByteLength,a=e.adjustScalarBytes||(t=>t),s=e.powPminus2||(t=>K(t,r-BigInt(2),r));function l(t,e,r){let i=n(t*(e-r));return[e=n(e-i),r=n(r+i)]}let d=(e.a-BigInt(2))/BigInt(4);function c(t,e){let c=function(t,e){L("u",t,tR,r),L("scalar",e,tR,r);let f,o=tU,a=tR,c=t,h=tU,u=tR;for(let r=BigInt(i-1);r>=tR;r--){let i=e>>r&tU;u^=i,o=(f=l(u,o,c))[0],c=f[1],a=(f=l(u,a,h))[0],h=f[1],u=i;let s=o+a,b=n(s*s),g=o-a,p=n(g*g),x=b-p,y=c+h,w=n((c-h)*s),B=n(y*g),m=w+B,E=w-B;c=n(m*m),h=n(t*n(E*E)),o=n(b*p),a=n(x*(b+n(d*x)))}return o=(f=l(u,o,c))[0],c=f[1],a=(f=l(u,a,h))[0],h=f[1],n(o*s(a))}(function(t){let e=v("u coordinate",t,f);return 32===o&&(e[31]&=127),m(e)}(e),function(t){let e=v("scalar",t),r=e.length;if(r!==f&&r!==o)throw Error("invalid scalar, expected "+f+" or "+o+" bytes, got "+r);return m(a(e))}(t));if(c===tR)throw Error("invalid private or public key received");return I(n(c),f)}let h=I(n(e.Gu),f);function u(t){return c(t,h)}return{scalarMult:c,scalarMultBase:u,getSharedSecret:(t,e)=>c(t,e),getPublicKey:t=>u(t),utils:{randomPrivateKey:()=>e.randomBytes(e.nByteLength)},GuBytes:h}}({a:BigInt(156326),montgomeryBits:448,nByteLength:56,P:tz,Gu:BigInt(5),powPminus2:t=>V(M(tZ(t),BigInt(2),tz)*t,tz),adjustScalarBytes:tD,randomBytes:i.r});tV.ORDER,BigInt(3),BigInt(4),BigInt(156326),BigInt("39082"),BigInt("78163"),BigInt("98944233647732219769177004876929019128417576295529901074099889598043702116001257856802131563896515373927712232092845883226922417596214"),BigInt("315019913931389607337177038330951043522456072897266928557328499619017160722351061360252776265186336876723201881398623946864393857820716"),BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");let tY=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),tW=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),tX=BigInt(1),tJ=BigInt(2),tQ=(t,e)=>(t+e/tJ)/e,t$=J(tY,void 0,void 0,{sqrt:function(t){let e=BigInt(3),r=BigInt(6),n=BigInt(11),i=BigInt(22),f=BigInt(23),o=BigInt(44),a=BigInt(88),s=t*t*t%tY,l=s*s*t%tY,d=M(l,e,tY)*l%tY,c=M(d,e,tY)*l%tY,h=M(c,tJ,tY)*s%tY,u=M(h,n,tY)*h%tY,b=M(u,i,tY)*u%tY,g=M(b,o,tY)*b%tY,p=M(g,a,tY)*g%tY,x=M(p,o,tY)*b%tY,y=M(x,e,tY)*l%tY,w=M(y,f,tY)*u%tY,B=M(w,r,tY)*s%tY,m=M(B,tJ,tY);if(!t$.eql(t$.sqr(m),t))throw Error("Cannot find square root");return m}}),t0=ty({a:BigInt(0),b:BigInt(7),Fp:t$,n:tW,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{let e=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-tX*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),n=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),i=BigInt("0x100000000000000000000000000000000"),f=tQ(e*t,tW),o=tQ(-r*t,tW),a=V(t-f*e-o*n,tW),s=V(-f*r-o*e,tW),l=a>i,d=s>i;if(l&&(a=tW-a),d&&(s=tW-s),a>i||s>i)throw Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:l,k1:a,k2neg:d,k2:s}}}},n.s);BigInt(0),t0.ProjectivePoint;let t1=J(BigInt("0xa9fb57dba1eea9bc3e660a909d838d726e3bf623d52620282013481d1f6e5377")),t2=ty({a:t1.create(BigInt("0x7d5a0975fc2c3057eef67530417affe7fb8055c126dc5c6ce94a4b44f330b5d9")),b:BigInt("0x26dc5c6ce94a4b44f330b5d9bbd77cbf958416295cf7e1ce6bccdc18ff8c07b6"),Fp:t1,n:BigInt("0xa9fb57dba1eea9bc3e660a909d838d718c397aa3b561a6f7901e0e82974856a7"),Gx:BigInt("0x8bd2aeb9cb7e57cb2c4b482ffc81b7afb9de27e1e3bd23c23a4453bd9ace3262"),Gy:BigInt("0x547ef835c3dac4fd97f8461a14611dc9c27745132ded8e545c1d54c72f046997"),h:BigInt(1),lowS:!1},n.s),t8=J(BigInt("0x8cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b412b1da197fb71123acd3a729901d1a71874700133107ec53")),t3=ty({a:t8.create(BigInt("0x7bc382c63d8c150c3c72080ace05afa0c2bea28e4fb22787139165efba91f90f8aa5814a503ad4eb04a8c7dd22ce2826")),b:BigInt("0x04a8c7dd22ce28268b39b55416f0447c2fb77de107dcd2a62e880ea53eeb62d57cb4390295dbc9943ab78696fa504c11"),Fp:t8,n:BigInt("0x8cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b31f166e6cac0425a7cf3ab6af6b7fc3103b883202e9046565"),Gx:BigInt("0x1d1c64f068cf45ffa2a63a81b7c13f6b8847a3e77ef14fe3db7fcafe0cbd10e8e826e03436d646aaef87b2e247d4af1e"),Gy:BigInt("0x8abe1d7520f9c2a45cb1eb8e95cfd55262b70b29feec5864e19c054ff99129280e4646217791811142820341263c5315"),h:BigInt(1),lowS:!1},n.a),t6=J(BigInt("0xaadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca703308717d4d9b009bc66842aecda12ae6a380e62881ff2f2d82c68528aa6056583a48f3")),t4=new Map(Object.entries({nistP256:tB,nistP384:tE,nistP521:tS,brainpoolP256r1:t2,brainpoolP384r1:t3,brainpoolP512r1:ty({a:t6.create(BigInt("0x7830a3318b603b89e2327145ac234cc594cbdd8d3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94ca")),b:BigInt("0x3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94cadc083e67984050b75ebae5dd2809bd638016f723"),Fp:t6,n:BigInt("0xaadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca70330870553e5c414ca92619418661197fac10471db1d381085ddaddb58796829ca90069"),Gx:BigInt("0x81aee4bdd82ed9645a21322e9c4c6a9385ed9f70b5d916c1b43b62eef4d0098eff3b1f78e2d0d48d50d1687b93b97d5f7c6d5047406a5e688b352209bcb9f822"),Gy:BigInt("0x7dde385d566332ecc0eabfa9cf7822fdf209f70024a57b1aa000c55b881f8111b2dcde494a5f485e5bca4bd88a2763aed1ca2b2fa8f0540678cd1e0f3ad80892"),h:BigInt(1),lowS:!1},n.b),secp256k1:t0,x448:tM,ed448:tK}))}}]);
